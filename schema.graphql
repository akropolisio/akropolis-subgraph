###############
### SAVINGS ###
###############

type SavingsPool @entity {
  "address"
  id: ID!
  poolToken: Token!
  tokens: [Token!]!
  rewardTokens: [Token!]!
  apr: SPoolApr!
  prevBalance: SPoolBalance!
  balance: SPoolBalance!

  rewards: [SReward!]! @derivedFrom(field: "pool")
  aprHistory: [SPoolApr!]! @derivedFrom(field: "pool")
  balanceHistory: [SPoolBalance!]! @derivedFrom(field: "pool")
  users: [User!]! @derivedFrom(field: "savingsPools")
  distributions: [SPoolYieldDistribution!]! @derivedFrom(field: "pool")
}

type SReward @entity {
  id: ID!
  pool: SavingsPool!
  poolBalance: SPoolBalance!
  token: Token!
  amount: BigInt!
  date: BigInt!
}

type SPoolApr @entity {
  id: ID!
  amount: BigInt!
  date: BigInt!
  duration: BigInt!
  pool: SavingsPool!
  txHash: Bytes!
}

type SPoolBalance @entity {
  id: ID!
  amount: BigInt!
  date: BigInt!
  pool: SavingsPool!
}

type SPoolYieldDistribution @entity {
  id: ID!
  pool: SavingsPool!
  amount: BigInt!
}
##################
### INVESTMENT ###
##################

type InvestmentPool @entity {
  "address"
  id: ID!
  poolToken: Token!
  tokens: [Token!]!
  rewardTokens: [Token!]!
  apr: IPoolApr!

  rewards: [IReward!]! @derivedFrom(field: "pool")
  aprHistory: [IPoolApr!]! @derivedFrom(field: "pool")
  users: [User!]! @derivedFrom(field: "investmentPools")
  distributions: [IPoolYieldDistribution!]! @derivedFrom(field: "pool")
}

type IReward @entity {
  id: ID!
  pool: InvestmentPool!
  token: Token!
  amount: BigInt!
  date: BigInt!
}

type IPoolApr @entity {
  id: ID!
  amount: BigInt!
  date: BigInt!
  duration: BigInt!
  pool: InvestmentPool!
}

type IPoolYieldDistribution @entity {
  id: ID!
  pool: InvestmentPool!
  amount: BigInt!
}

#############
### OTHER ###
#############

type User @entity {
  "address"
  id: ID!

  savingsPools: [SavingsPool!]!
  investmentPools: [InvestmentPool!]!
}

type Token @entity {
  "address"
  id: ID!
  name: String!
  symbol: String!
  decimals: Int!
}

type GlobalStat @entity {
  id: ID!
  activeMembersCount: Int!
}

type SubgraphConfig @entity {
  id: ID!
  aprDecimals: Int!
}

enum SingleEntityID {
  ID
}
